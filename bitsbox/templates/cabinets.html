{% extends "_layout/base.html" %}

{% block styles %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/cabinet.css') }}">
{% endblock %}

{% block content %}

{% macro render_layout(path, layout) %}
{% if layout.type == 'container' %}
  <div class="bb-container" style="
      flex-flow: {{ layout.flow | default('row nowrap') }};
      margin: {{ layout.margin | default('auto') }};
      width: {{ layout.width | default('auto') }};
      height: {{ layout.height | default('auto') }};">
    {% for item in layout['items'] %}
      {{ render_layout(path + [loop.index0], item) }}
    {% endfor %}
  </div>
{% elif layout.type == 'drawer' %}
  <div class="bb-container-item grey lighten-2 z-depth-1" style="flex-grow: 1;
      margin: {{ layout.margin | default('auto') }};
      width: {{ layout.width | default('auto') }};
      height: {{ layout.height | default('auto') }};">
    <p>{{ path | join('.') }}</p>
  </div>
{% endif %}
{% endmacro %}

{% for cabinet in cabinets %}
<div>
  <h4>{{ cabinet.name }}</h4>
{% with layout = cabinet.layout | fromjson %}
  <div class="bb-container-toplevel">
    <div class="bb-container-toplevel-interior z-depth-2 grey lighten-1">
      {{ render_layout([], layout) }}
    </div>
  </div>
{% endwith %}
</div>
{% endfor %}

{% endblock %}
